# YouTube批量下载工具更新日志

# YouTube 批量下载工具

## 更新说明（2025-05-11）

### 新增功能

1. **自动检测并下载 ffmpeg**
   - 启动程序时会自动检测工具目录下是否存在 `ffmpeg.exe`，如不存在会自动联网下载并解压到本地，无需用户手动配置。
   - 若自动下载失败，会提示用户手动下载并放置到工具目录。

2. **多线程并发下载**
   - 支持同时下载多个视频，极大提升批量下载效率。
   - 默认最大并发数为 3，可根据需要在 config.ini 代码中调整。

3. **下载进度与状态实时显示**
   - 每个任务的进度和状态在界面中实时更新，便于用户掌控下载情况。

4. **完善的错误提示与处理**
   - 包括权限不足、ffmpeg 缺失、网络异常等，均有友好提示。

---

## 使用说明

### 1. 环境准备

- **Python 3.7 及以上**
- **依赖库**：`yt-dlp`、`tkinter`、`requests` 等（详见 `requirements.txt`）

### 2. 启动程序

双击 `main.py` ，启动程序。

### 3. 首次启动自动检测 ffmpeg

- 程序会自动检测 `ffmpeg.exe` 是否存在于工具目录。
- 若不存在，会自动联网下载并解压。
- 若自动下载失败（如网络受限），请手动访问 [ffmpeg官方下载地址](https://www.gyan.dev/ffmpeg/builds/ffmpeg-release-essentials.zip)，
  解压后将 `bin/ffmpeg.exe` 复制到本程序目录下。

### 4. 批量下载操作

1. **输入链接**  
   - 支持单个或批量粘贴 YouTube 视频链接。
2. **设置下载参数**  
   - 选择视频质量（如 4K、1080p 等）。
   - 选择下载类型（视频+音频、仅视频、仅音频）。
   - 设置下载保存路径。
3. **开始下载**  
   - 点击“开始下载”按钮，程序会自动并发下载所有任务。
   - 下载进度和状态会在界面中实时显示。

### 5. 代理设置（如需）

- 支持 HTTP/HTTPS 代理，适用于需要科学上网的环境。
- 可在“下载设置”中配置和测试代理。

### 6. 常见问题

- **权限不足**：请将下载目录设置为有写权限的位置，或以管理员身份运行程序。
- **ffmpeg下载失败**：请手动下载并放到工具目录。
- **网络异常**：请检查网络连接或设置代理。

---

## 目录结构
├── main.py
├── ytdlp_downloader.py
├── config.ini
├── requirements.txt
├── ffmpeg.exe（自动下载或手动放置）
├── ...


---

## 联系与反馈

如有问题或建议，请在 [GitHub Issues](#) 提交，或联系开发者邮箱。

---

**感谢使用本工具，祝您下载愉快！**

## 版本 2.0.0 (2025-05-01)

### 重大变更

- **核心下载引擎替换**：从pytube库迁移到yt-dlp库
- **依赖更新**：requirements.txt更新，替换pytube为yt-dlp

### 新增功能

- 更稳定的下载体验，大幅降低HTTP Error 400错误发生率
- 更好的代理支持和网络错误处理
- 支持更多视频格式和分辨率选项
- 改进的下载进度显示

### 修复问题

- 修复因YouTube API变更导致的下载失败问题
- 修复某些特殊格式视频无法下载的问题
- 修复下载大文件时可能出现的内存问题

### 技术细节

- 新增ytdlp_downloader.py实现基于yt-dlp的下载功能
- 更新run.py和offline_install.py中的依赖检查
- 更新main.py使用新的下载器

## 如何更新

只需运行`run.py`，程序会自动检查并安装所需的依赖：

```
python run.py
```

如果您想手动更新，可以运行：

```
pip install -r requirements.txt
```

## 注意事项

- 首次使用新版本时，建议清空下载队列重新添加
- 如果您使用了自定义的pytube相关脚本，这些可能需要重新适配
- 详细的迁移说明请参考「从pytube迁移到yt-dlp指南.md」